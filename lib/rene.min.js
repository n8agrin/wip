(function(){var a,b,c=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};b={},typeof module!="undefined"&&module!==null?module.exports=b:this.rene=b,b.utils={translate:function(a,b){return["translate(",String(a),",",String(b),")"].join("")}},b.chart=function(){var a,d,e,f,g,h,i,j,k;return h={top:20,bottom:20,left:30,right:20},f=[],i={},e=500,d=200,g=function(){},j=d3.svg.axis().orient("bottom"),k=d3.svg.axis().orient("left"),a=function(d){return d.each(function(d){var e,l,m,n,o,p,q,r,s,t,u,v;r=d3.select(this).selectAll("svg").data([d]),l=r.enter().append("svg").attr("class","plot").append("g"),l.append("g").attr("class","x axis"),l.append("g").attr("class","y axis"),l.append("g").attr("class","geoms"),n=r.select("g.geoms").selectAll("g.layer").data(Object),n.enter().append("g").attr("class","layer").attr("id",function(a,b){return"layer"+b});for(t=0,u=f.length;t<u;t++){m=f[t],v=m.scales();for(e in v)q=v[e],i[e]||(i[e]=q())}return n.each(function(a,b){var d,e,g,h,j,k,l,n,o,p,q;m=f[b],q=[];for(d in i){j=i[d];if(m[d]){g=a.map(m[d]()),k=j.domain();if(d==="color"){for(l=0,o=g.length;l<o;l++)e=g[l],c.call(k,e)<0&&k.push(e);q.push(j.domain(k))}else if(j.rangeBand){for(n=0,p=g.length;n<p;n++)h=g[n],c.call(k,h)<0&&k.push(h);q.push(j.domain(k))}else q.push(j.domain(d3.extent(g.concat(k))))}else q.push(void 0)}return q}),s=r.node(),p=s.clientWidth-(h.left+h.right),o=s.clientHeight-(h.top+h.bottom),i.x&&(i.x.rangeBand!=null?i.x.rangeBands([0,p],.1):i.x.range([0,p]),j.scale(i.x),r.select(".x.axis").attr("transform",b.utils.translate(0,o)).call(j)),i.y&&(i.y.range([o,0]),k.scale(i.y),r.select(".y.axis").call(k)),r.select("g").attr("transform",b.utils.translate(h.left,h.top)),n.each(function(a,b){return d3.transition(d3.select(this)).call(f[b],i,p,o)}),n.each(function(a,b){return f[b].position(d3.select(this),p,o,h)}),g.call(a,n,i,p,o)})},a.margin=function(b){return b?(h=b,a):h},a.layerDuration=function(b){return b?(e=b,a):e},a.layerDelay=function(b){return b?(d=b,a):d},a.legend=function(b){return b?(g=b,a):g},a.scales=function(b){return b?(i=b,a):i},a.xAxis=function(b){return b?(j=b,a):j},a.yAxis=function(b){return b?(k=b,a):k},a.layers=function(b){return b?(f=b,a):f},a.addLayer=function(b){return f.push(b),a},a},b.scatter=function(){var a,b,c,d,e,f;return e=function(a){return a[0]},f=function(a){return a[1]},a=function(a){return"blue"},d=function(a){return 2},c={x:d3.scale.linear,y:d3.scale.linear,color:d3.scale.category20,size:d3.scale.linear},b=function(a,c){return a.each(function(){var a,d,e,f,g,h,i,j;return e=b.x(),f=b.y(),a=b.color(),d=b.size(),g=d3.select(this).selectAll("circle").data(Object),h=g.enter().append("circle").attr("opacity",1e-6),i=d3.transition(g.exit()).attr("opacity",0).remove(),j=d3.transition(g).attr("opacity",1),j.attr("cx",function(a){return c.x(e(a))}).attr("cy",function(a){return c.y(f(a))}).attr("r",function(a){return d(a)}).style("fill",function(b){return a(b)})})},b.x=function(a){return a?(e=d3.functor(a),b):e},b.y=function(a){return a?(f=d3.functor(a),b):f},b.color=function(c){return c?(a=d3.functor(c),b):a},b.size=function(a){return a?(d=d3.functor(a),b):d},b.scales=function(){return c},b.position=function(){},b},a=function(){var a,b,c,d;return b=function(a,c){return a.each(function(d){var e,f,h,i,j;return a=d3.select(this),e=a.selectAll("path").data([a.datum()]),f=e.enter().append("path"),h=d3.transition(e.exit()),i=d3.transition(e),j=d3.svg.line().interpolate(b.interpolate()).x(function(a){return c.x(b.x()(a))}).y(function(a){return c.y(b.y()(a))}),i.attr("d",j)})},a={x:function(a){return a[0]},y:function(a){return a[1]},color:function(a){return a[2]},size:function(a){return a[3]},interpolate:"cardinal"},c={x:d3.scale.linear,y:d3.scale.linear,color:d3.scale.category20,size:d3.scale.linear},d=attrAccessor.bind(a,b),b.x=d("x"),b.y=d("y"),b.color=d("color"),b.size=d("size"),b.interpolate=d("interpolate"),b.scales=function(){return c},b.position=function(){},b},b.bar=function(){var a,b,c,d;return b=function(b,c,d,e){return b.each(function(d,f){var i,j,k,l;return b=d3.select(this),i=b.selectAll("rect").data(d),j=i.enter().append("rect"),k=d3.transition(i.exit()).remove(),l=d3.transition(i).attr("x",function(b){return c.x(a.x(b))}).attr("y",function(b){return c.y(a.y(b))}).attr("height",function(b){return e-c.y(a.y(b))}).attr("width",function(){return rangeBands(c.x)})})},a={x:function(a){return a[0]},y:function(a){return a[1]},color:function(a){return a[2]},size:function(a){return a[3]}},c={x:d3.scale.ordinal,y:d3.scale.linear,color:d3.scale.category20,size:d3.scale.linear},d=attrAccessor.bind(a,b),b.x=d("x"),b.y=d("y"),b.color=d("color"),b.size=d("size"),b.scales=function(){return c},b.position=function(){},b.interval=function(a){return a},b},b.pie=function(){var a,b,c,d;return c=function(a,c,d,e){return a.each(function(f,h){var i,j,k,l,m,n,o,p,q;return p=b.pie,q=p(f.map(b.value)),o=b.outerRadius,n=b.innerRadius,typeof o=="function"&&(o=o(d,e)),typeof n=="function"&&(n=n(d,e)),i=b.arc.outerRadius(o).innerRadius(n),a=d3.select(this).classed("pie",!0),j=a.selectAll("path.arc").data(f),k=j.enter().append("path").attr("class","arc").style("opacity",1e-6),l=d3.transition(j.exit()).style("opacity",1e-6).remove(),m=d3.transition(j).style("opacity",1),m.attr("d",function(a,b){return i(q[b])}).attr("fill",function(a,d){return c.color(b.color(a,d))})})},d={color:d3.scale.category20},b={outerRadius:100,innerRadius:10,location:"center",locationMargin:10,arc:d3.svg.arc(),pie:d3.layout.pie(),color:function(a,b){return a.data},value:function(a){return a},label:function(a){return a}},a=attrAccessor.bind(b,c),c.outerRadius=a("outerRadius"),c.innerRadius=a("innerRadius"),c.arc=a("arc"),c.pie=a("pie"),c.location=a("location"),c.color=a("color"),c.value=a("value"),c.label=a("label"),c.scales=function(){return d},c.position=function(a,c,d,e){switch(b.location){case"center":return a.attr("transform",utils.translate(c/2,d/2));case"left":return a.attr("transform",utils.translate(b.outerRadius(c,d),d/2))}},c}}).call(this);